#!/usr/bin/env ruby

require 'nokogiri'
require 'open-uri'
require 'rainbow'
require 'cgi'

Sickill::Rainbow.enabled = true

q = ARGV.join(' ')
doc = Nokogiri::HTML(open('http://eow.alc.co.jp/search?q=' + q).read)

doc.css('div#resultsArea div#resultsList ul').children.each do |x|
  next if x.text.strip.empty?
  puts x.css('.midashi').text.color(:green)
  if x.css('div span').count > 1
    tmp = ''
    x.css('div').children.each do |y|
      if y.attr('class') == 'wordclass'
        puts tmp, '' unless tmp.strip.empty?
        puts y.text.underline
        tmp = "\t"
      else
        tmp += y.text
      end
    end
    puts tmp unless tmp.strip.empty?
  else
    puts x.css('div').text
  end

  puts '----------------'
end



