#!/usr/bin/env ruby

require 'nokogiri'
require 'open-uri'
require 'rainbow'
require 'cgi'

Sickill::Rainbow.enabled = true

q = ARGV.join(' ')
doc = Nokogiri::HTML(open('http://eow.alc.co.jp/search?q=' + q).read)

doc.css('div#resultsArea div#resultsList ul').children.each do |x|
  next if x.text.strip.empty?
  puts x.css('.midashi').text.color(:green)
  if x.css('div span').count > 1
    x.css('div').children.each do |y|
      if y.attr('class') == 'label' || y.attr('class') == 'wordclass'
        puts y.text.underline
        print "\t"
      else
        if y.attr('class') == 'kana'
          next
        elsif y.next and y.next.attr('class') == 'kana'
          print y.text
        else
          puts y.text
        end

      end
    end
  else
    puts x.css('div').text
  end

  puts '----------------'
end



